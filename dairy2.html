<!DOCTYPE html>
<html>
  <head>
    <base target="_top">
    <meta charset="UTF-8">
    <title>FLR Diary Entry</title>
    <style>
      body { font-family: Arial; padding: 1em; max-width: 600px; margin: auto; }
      textarea, select, button { width: 100%; margin-top: 1em; padding: .5em; }
      #status { font-weight: bold; margin-top: 1em; color: green; }
      .error { color: red; }
    </style>
  </head>
  <body>
    <h1>FLR Diary Entry</h1>
    <label>Mood:</label>
    <select id="mood">
      <option value="😊">😊 Happy</option>
      <option value="😐">😐 Neutral</option>
      <option value="😞">😞 Sad</option>
      <option value="😡">😡 Frustrated</option>
      <option value="😴">😴 Tired</option>
    </select>

    <label>Diary Note:</label>
    <textarea id="entry" placeholder="Your note..." rows="6"></textarea>

    <button onclick="submitEntry()">Submit</button>

    <div id="status"></div>

    <script>
      function submitEntry() {
        const mood = document.getElementById('mood').value;
        const entry = document.getElementById('entry').value.trim();
        const status = document.getElementById('status');
        status.innerHTML = 'Submitting...';
        status.className = '';

        google.script.run
          .withSuccessHandler(() => {
            status.innerHTML = '✅ Entry saved!';
            document.getElementById('entry').value = '';
          })
          .withFailureHandler(err => {
            status.innerHTML = '❌ Error: ' + err.message;
            status.className = 'error';
          })
          .saveEntry(mood, entry);
      }
    </script>
  </body>
</html>
